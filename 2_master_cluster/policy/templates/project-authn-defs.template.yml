---
# This policy defines the Projects that can authenticate to Conjur.
# The project name can apply to more than one service (i.e. application layer) deployed in the same project.
- !policy
  id: conjur/authn-k8s/{{ AUTHENTICATOR_SERVICE_ID }}/apps
  annotations:
    description: Identities permitted to authenticate 
  body:
  - !layer
    annotations:
      description: Layer of authenticator identities permitted to call authn svc
  - &hosts
    - !host
      id: {{ TEST_APP_PROJECT_NAME }}/*/*
      annotations:
        kubernetes/authentication-container-name: authenticator
        openshift: "true"

  - !grant
    role: !layer
    members: *hosts
