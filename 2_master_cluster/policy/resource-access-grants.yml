---
- !user bob

- !policy
  id: secrets
  annotations:
    description: This policy grants secrets access to application layers
  body:

  - !variable db-username
  - !variable db-password

  - !permit
    privileges: [ read, execute ]
    roles:
    - !layer /test-app
    resources:
    - !variable db-username
    - !variable db-password

  - !variable read-only

  - !permit
    privileges: [ read ]
    roles:
    - !user /bob
    resources:
    - !variable read-only
